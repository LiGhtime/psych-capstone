function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{cx2K:function(e,n,t){"use strict";t.r(n),t.d(n,"UserSettingsPageModule",(function(){return O}));var i=t("ofXK"),s=t("3Pt+"),o=t("c7TG"),a=t("tyNb"),r=t("mrSG"),c=t("Bg0J"),d=t("C6fG"),l=t("fXoL"),u=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}Object(r.c)(n,e),n.prototype.open=function(e){return Object(d.cordova)(this,"open",{},arguments)},n.pluginName="OpenNativeSettings",n.plugin="cordova-open-native-settings",n.pluginRef="cordova.plugins.settings",n.repo="https://github.com/guyromb/Cordova-open-native-settings",n.platforms=["Android","iOS"],n.\u0275fac=function(e){return t(e||n)},n.\u0275prov=l.Qb({token:n,factory:function(e){return n.\u0275fac(e)}});var t=l.Zb(n);return n}(d.IonicNativePlugin),b=t("l5mm"),w=t("tk/3");function f(e,n){if(1&e){var t=l.Yb();l.Xb(0,"ion-icon",13),l.fc("click",(function(){l.sc(t);var e=l.hc();return e.boundEmail=e.userEmail})),l.Wb()}}function g(e,n){1&e&&(l.Xb(0,"div",14),l.wc(1,"Must be valid email"),l.Wb())}function h(e,n){if(1&e){var t=l.Yb();l.Xb(0,"ion-icon",13),l.fc("click",(function(){return l.sc(t),l.hc().resetPasswordForm()})),l.Wb()}}function p(e,n){if(1&e){var t=l.Yb();l.Xb(0,"ion-item",15),l.Xb(1,"ion-input",16),l.fc("click",(function(){l.sc(t);var e=l.hc();return e.editingPassword=!e.editingPassword})),l.Wb(),l.Wb()}if(2&e){var i=l.hc();l.kc("disabled",i.waitingForResponse),l.Kb(1),l.lc("value",i.placeholderPassword)}}function v(e,n){1&e&&(l.Xb(0,"div",14),l.wc(1,"Must a new password with 1 uppercase letter, 1 lowercase letter, 1 number, no spaces, and 7-16 characters"),l.Wb())}function m(e,n){1&e&&(l.Xb(0,"div",14),l.wc(1,"Matches new password"),l.Wb())}function P(e,n){1&e&&(l.Xb(0,"div",14),l.wc(1,"Must be match previous entry"),l.Wb())}function k(e,n){1&e&&(l.Xb(0,"span"),l.wc(1,"Save"),l.Wb())}function F(e,n){1&e&&l.Vb(0,"ion-spinner",25)}function y(e,n){if(1&e){var t=l.Yb();l.Xb(0,"ion-item",22),l.Xb(1,"ion-button",23),l.fc("click",(function(){return l.sc(t),l.hc(2).saveForm()})),l.vc(2,k,2,0,"span",10),l.vc(3,F,1,0,"ion-spinner",24),l.Wb(),l.Wb()}if(2&e){var i=l.hc(2);l.Kb(1),l.kc("disabled",i.waitingForResponse),l.Kb(1),l.kc("ngIf",!i.waitingForResponse),l.Kb(1),l.kc("ngIf",i.waitingForResponse)}}var C=function(e,n){return{valid:e,invalid:n}};function W(e,n){if(1&e){var t=l.Yb();l.Xb(0,"div"),l.Xb(1,"ion-item",17),l.Xb(2,"ion-input",18),l.fc("ngModelChange",(function(e){return l.sc(t),l.hc().oldPassword=e})),l.Wb(),l.Wb(),l.Xb(3,"ion-item",17),l.Xb(4,"ion-input",19),l.fc("ngModelChange",(function(e){return l.sc(t),l.hc().newPasswordFirst=e})),l.Wb(),l.Wb(),l.vc(5,v,2,0,"div",8),l.vc(6,m,2,0,"div",8),l.Xb(7,"ion-item",17),l.Xb(8,"ion-input",20),l.fc("ngModelChange",(function(e){return l.sc(t),l.hc().newPasswordSecond=e})),l.Wb(),l.Wb(),l.vc(9,P,2,0,"div",8),l.vc(10,y,4,3,"ion-item",21),l.Wb()}if(2&e){var i=l.hc();l.Kb(1),l.kc("ngClass",l.oc(13,C,i.validatePassword(i.oldPassword),!i.validatePassword(i.oldPassword)&&""!=i.oldPassword))("disabled",i.waitingForResponse),l.Kb(1),l.kc("ngModel",i.oldPassword),l.Kb(1),l.kc("ngClass",l.oc(16,C,i.validatePassword(i.newPasswordFirst)&&i.oldPassword!=i.newPasswordFirst,""!=i.newPasswordFirst&&(!i.validatePassword(i.newPasswordFirst)||i.oldPassword==i.newPasswordFirst)))("disabled",i.waitingForResponse),l.Kb(1),l.kc("ngModel",i.newPasswordFirst),l.Kb(1),l.kc("ngIf",!i.validatePassword(i.newPasswordFirst)&&""!=i.newPasswordFirst),l.Kb(1),l.kc("ngIf",""!=i.newPasswordFirst&&i.oldPassword==i.newPasswordFirst),l.Kb(1),l.kc("ngClass",l.oc(19,C,i.newPasswordFirst==i.newPasswordSecond&&""!=i.newPasswordFirst,i.newPasswordFirst!=i.newPasswordSecond))("disabled",i.waitingForResponse),l.Kb(1),l.kc("ngModel",i.newPasswordSecond),l.Kb(1),l.kc("ngIf",i.newPasswordFirst!=i.newPasswordSecond),l.Kb(1),l.kc("ngIf",i.validateForm()||i.waitingForResponse)}}function X(e,n){1&e&&(l.Xb(0,"ion-label"),l.wc(1,"On"),l.Wb())}function I(e,n){1&e&&(l.Xb(0,"ion-label"),l.wc(1,"Off"),l.Wb())}var E,K,R,S=[{path:"",component:(E=function(){function e(n,t,i,s){_classCallCheck(this,e),this.toastController=n,this.localNotifications=t,this.openNativeSettings=i,this.http=s,this.placeholderPassword="12345678",this.oldPassword="",this.newPasswordFirst="",this.newPasswordSecond="",this.emailPattern=/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/,this.editingPassword=!1,this.waitingForResponse=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.userEmail=localStorage.getItem("username"),this.boundEmail=this.userEmail}},{key:"ionViewWillEnter",value:function(){var e=this;this.updateNotification=Object(b.a)(2e3).subscribe((function(){return Object(r.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localNotifications.hasPermission();case 2:this.notifications=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}))}},{key:"ionViewWillLeave",value:function(){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateNotification.unsubscribe();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"validateEmail",value:function(){return this.boundEmail!=this.userEmail?this.emailPattern.test(this.boundEmail):null}},{key:"validatePasswords",value:function(){if(this.editingPassword){var e=!0;return(e=(e=(e=e&&this.validatePassword(this.newPasswordFirst))&&this.validatePassword(this.newPasswordSecond))&&this.validatePassword(this.oldPassword))&&this.newPasswordFirst==this.newPasswordSecond&&""!=this.oldPassword&&""!=this.newPasswordFirst&&this.oldPassword!=this.newPasswordFirst}return null}},{key:"validatePassword",value:function(e){return/[a-z]/.test(e)&&/[A-Z]/.test(e)&&/[0-9]/.test(e)&&e.length>=7&&e.length<=16&&e.indexOf(" ")<0}},{key:"formTouched",value:function(){return this.boundEmail!=this.userEmail||this.editingPassword}},{key:"validateForm",value:function(){return(this.validateEmail()||null==this.validateEmail())&&(this.validatePasswords()||null==this.validatePasswords())&&this.formTouched()}},{key:"saveForm",value:function(){var e=this;if(this.validateForm()){var n={email:localStorage.getItem("username"),oldpassword:this.oldPassword,newpassword:this.newPasswordFirst},t={headers:new w.c({"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer "+localStorage.getItem("token")})};this.waitingForResponse=!0,this.http.put("https://crossfacerecognition.herokuapp.com/changepassword/",n,t).subscribe((function(){e.waitingForResponse=!1,e.resetPasswordForm(),e.successToast("Your settings have been saved")}),(function(n){e.waitingForResponse=!1,e.dangerToast("Password does not match"==n.error?"Old password incorrect":"Something went wrong. Please try again later")}))}else this.dangerToast("Invalid fields")}},{key:"resetPasswordForm",value:function(){this.editingPassword=!1,this.oldPassword="",this.newPasswordFirst="",this.newPasswordSecond=""}},{key:"dangerToast",value:function(e){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.toastController.create({message:e,color:"danger",duration:2e3});case 2:n.sent.present();case 3:case"end":return n.stop()}}),n,this)})))}},{key:"successToast",value:function(e){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.toastController.create({message:e,color:"success",duration:2e3});case 2:n.sent.present();case 3:case"end":return n.stop()}}),n,this)})))}},{key:"openSettings",value:function(){this.openNativeSettings.open("application_details")}}]),e}(),E.\u0275fac=function(e){return new(e||E)(l.Ub(o.P),l.Ub(c.a),l.Ub(u),l.Ub(w.a))},E.\u0275cmp=l.Ob({type:E,selectors:[["app-user-settings"]],decls:26,vars:12,consts:[["slot","start"],["autoHide","false"],[2,"--background","gray"],[2,"margin-top","5%","margin-left","5%","display","flex","align-items","center","justify-content","space-between"],[2,"color","white"],["style","align-self: flex-end; margin-right: 5%; font-size: 120%","name","close-circle-outline",3,"click",4,"ngIf"],["lines","none","disabled","",3,"ngClass"],["type","email","clearInput","",3,"ngModel","ngModelChange"],["style","color: white; margin-top: 2%; margin-left: 7%; font-size: 4vw",4,"ngIf"],["lines","none",3,"disabled",4,"ngIf"],[4,"ngIf"],[2,"margin-top","5%","margin-left","5%"],["button","","lines","none",3,"click"],["name","close-circle-outline",2,"align-self","flex-end","margin-right","5%","font-size","120%",3,"click"],[2,"color","white","margin-top","2%","margin-left","7%","font-size","4vw"],["lines","none",3,"disabled"],["type","password","button","",3,"value","click"],["lines","none",3,"ngClass","disabled"],["placeholder","Old Password","type","password","clearInput","",3,"ngModel","ngModelChange"],["placeholder","New Password","type","password","clearInput","",3,"ngModel","ngModelChange"],["placeholder","Confirm Password","type","password","clearInput","",3,"ngModel","ngModelChange"],["lines","none","style","--background: grey; border-radius: 0px; margin-left: 0px; margin-right: 0px",4,"ngIf"],["lines","none",2,"--background","grey","border-radius","0px","margin-left","0px","margin-right","0px"],[2,"height","90%","width","45%","margin-left","50%",3,"disabled","click"],["name","dots",4,"ngIf"],["name","dots"]],template:function(e,n){1&e&&(l.Xb(0,"ion-header"),l.Xb(1,"ion-toolbar"),l.Xb(2,"ion-title"),l.wc(3,"Settings"),l.Wb(),l.Xb(4,"ion-buttons",0),l.Vb(5,"ion-menu-button",1),l.Wb(),l.Wb(),l.Wb(),l.Xb(6,"ion-content",2),l.Xb(7,"div",3),l.Xb(8,"div",4),l.wc(9,"Email Address:"),l.Wb(),l.vc(10,f,1,0,"ion-icon",5),l.Wb(),l.Xb(11,"ion-item",6),l.Xb(12,"ion-input",7),l.fc("ngModelChange",(function(e){return n.boundEmail=e})),l.Wb(),l.Wb(),l.vc(13,g,2,0,"div",8),l.Xb(14,"div",3),l.Xb(15,"div",4),l.wc(16,"Password:"),l.Wb(),l.vc(17,h,1,0,"ion-icon",5),l.Wb(),l.vc(18,p,2,2,"ion-item",9),l.vc(19,W,11,22,"div",10),l.Xb(20,"div",11),l.Xb(21,"div",4),l.wc(22,"Notifications:"),l.Wb(),l.Wb(),l.Xb(23,"ion-item",12),l.fc("click",(function(){return n.openSettings()})),l.vc(24,X,2,0,"ion-label",10),l.vc(25,I,2,0,"ion-label",10),l.Wb(),l.Wb()),2&e&&(l.Kb(10),l.kc("ngIf",n.boundEmail!=n.userEmail&&!n.waitingForResponse),l.Kb(1),l.kc("ngClass",l.oc(9,C,n.validateEmail(),n.boundEmail!=n.userEmail&&!n.validateEmail())),l.Kb(1),l.kc("ngModel",n.boundEmail),l.Kb(1),l.kc("ngIf",n.boundEmail!=n.userEmail&&!n.validateEmail()),l.Kb(4),l.kc("ngIf",n.editingPassword&&!n.waitingForResponse),l.Kb(1),l.kc("ngIf",!n.editingPassword),l.Kb(1),l.kc("ngIf",n.editingPassword),l.Kb(5),l.kc("ngIf",n.notifications),l.Kb(1),l.kc("ngIf",!n.notifications))},directives:[o.l,o.F,o.D,o.f,o.s,o.j,i.j,o.o,i.h,o.n,o.O,s.f,s.h,o.m,o.e,o.C,o.p],styles:["ion-item[_ngcontent-%COMP%]{margin-left:5%;margin-right:5%;margin-top:5%;border-radius:10px;background-color:#fff}.invalid[_ngcontent-%COMP%]{--background:#ffd1d1}.valid[_ngcontent-%COMP%]{--background:#cffdd9}"]}),E)}],M=((R=function e(){_classCallCheck(this,e)}).\u0275mod=l.Sb({type:R}),R.\u0275inj=l.Rb({factory:function(e){return new(e||R)},imports:[[a.i.forChild(S)],a.i]}),R),O=((K=function e(){_classCallCheck(this,e)}).\u0275mod=l.Sb({type:K}),K.\u0275inj=l.Rb({factory:function(e){return new(e||K)},providers:[c.a,u],imports:[[i.b,s.d,o.G,M]]}),K)}}]);