(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{cx2K:function(n,s,i){"use strict";i.r(s),i.d(s,"UserSettingsPageModule",(function(){return S}));var t=i("ofXK"),e=i("3Pt+"),o=i("c7TG"),a=i("tyNb"),r=i("mrSG"),d=i("Bg0J"),c=i("C6fG"),l=i("fXoL"),b=function(n){function s(){return null!==n&&n.apply(this,arguments)||this}Object(r.c)(s,n),s.prototype.open=function(n){return Object(c.cordova)(this,"open",{},arguments)},s.pluginName="OpenNativeSettings",s.plugin="cordova-open-native-settings",s.pluginRef="cordova.plugins.settings",s.repo="https://github.com/guyromb/Cordova-open-native-settings",s.platforms=["Android","iOS"],s.\u0275fac=function(n){return i(n||s)},s.\u0275prov=l.Qb({token:s,factory:function(n){return s.\u0275fac(n)}});var i=l.Zb(s);return s}(c.IonicNativePlugin),w=i("l5mm"),u=i("tk/3");function g(n,s){if(1&n){const n=l.Yb();l.Xb(0,"ion-icon",13),l.fc("click",(function(){l.sc(n);const s=l.hc();return s.boundEmail=s.userEmail})),l.Wb()}}function f(n,s){1&n&&(l.Xb(0,"div",14),l.wc(1,"Must be valid email"),l.Wb())}function h(n,s){if(1&n){const n=l.Yb();l.Xb(0,"ion-icon",13),l.fc("click",(function(){return l.sc(n),l.hc().resetPasswordForm()})),l.Wb()}}function p(n,s){if(1&n){const n=l.Yb();l.Xb(0,"ion-item",15),l.Xb(1,"ion-input",16),l.fc("click",(function(){l.sc(n);const s=l.hc();return s.editingPassword=!s.editingPassword})),l.Wb(),l.Wb()}if(2&n){const n=l.hc();l.kc("disabled",n.waitingForResponse),l.Kb(1),l.lc("value",n.placeholderPassword)}}function m(n,s){1&n&&(l.Xb(0,"div",14),l.wc(1,"Must a new password with 1 uppercase letter, 1 lowercase letter, 1 number, no spaces, and 7-16 characters"),l.Wb())}function v(n,s){1&n&&(l.Xb(0,"div",14),l.wc(1,"Matches new password"),l.Wb())}function P(n,s){1&n&&(l.Xb(0,"div",14),l.wc(1,"Must be match previous entry"),l.Wb())}function k(n,s){1&n&&(l.Xb(0,"span"),l.wc(1,"Save"),l.Wb())}function F(n,s){1&n&&l.Vb(0,"ion-spinner",25)}function W(n,s){if(1&n){const n=l.Yb();l.Xb(0,"ion-item",22),l.Xb(1,"ion-button",23),l.fc("click",(function(){return l.sc(n),l.hc(2).saveForm()})),l.vc(2,k,2,0,"span",10),l.vc(3,F,1,0,"ion-spinner",24),l.Wb(),l.Wb()}if(2&n){const n=l.hc(2);l.Kb(1),l.kc("disabled",n.waitingForResponse),l.Kb(1),l.kc("ngIf",!n.waitingForResponse),l.Kb(1),l.kc("ngIf",n.waitingForResponse)}}const X=function(n,s){return{valid:n,invalid:s}};function y(n,s){if(1&n){const n=l.Yb();l.Xb(0,"div"),l.Xb(1,"ion-item",17),l.Xb(2,"ion-input",18),l.fc("ngModelChange",(function(s){return l.sc(n),l.hc().oldPassword=s})),l.Wb(),l.Wb(),l.Xb(3,"ion-item",17),l.Xb(4,"ion-input",19),l.fc("ngModelChange",(function(s){return l.sc(n),l.hc().newPasswordFirst=s})),l.Wb(),l.Wb(),l.vc(5,m,2,0,"div",8),l.vc(6,v,2,0,"div",8),l.Xb(7,"ion-item",17),l.Xb(8,"ion-input",20),l.fc("ngModelChange",(function(s){return l.sc(n),l.hc().newPasswordSecond=s})),l.Wb(),l.Wb(),l.vc(9,P,2,0,"div",8),l.vc(10,W,4,3,"ion-item",21),l.Wb()}if(2&n){const n=l.hc();l.Kb(1),l.kc("ngClass",l.oc(13,X,n.validatePassword(n.oldPassword),!n.validatePassword(n.oldPassword)&&""!=n.oldPassword))("disabled",n.waitingForResponse),l.Kb(1),l.kc("ngModel",n.oldPassword),l.Kb(1),l.kc("ngClass",l.oc(16,X,n.validatePassword(n.newPasswordFirst)&&n.oldPassword!=n.newPasswordFirst,""!=n.newPasswordFirst&&(!n.validatePassword(n.newPasswordFirst)||n.oldPassword==n.newPasswordFirst)))("disabled",n.waitingForResponse),l.Kb(1),l.kc("ngModel",n.newPasswordFirst),l.Kb(1),l.kc("ngIf",!n.validatePassword(n.newPasswordFirst)&&""!=n.newPasswordFirst),l.Kb(1),l.kc("ngIf",""!=n.newPasswordFirst&&n.oldPassword==n.newPasswordFirst),l.Kb(1),l.kc("ngClass",l.oc(19,X,n.newPasswordFirst==n.newPasswordSecond&&""!=n.newPasswordFirst,n.newPasswordFirst!=n.newPasswordSecond))("disabled",n.waitingForResponse),l.Kb(1),l.kc("ngModel",n.newPasswordSecond),l.Kb(1),l.kc("ngIf",n.newPasswordFirst!=n.newPasswordSecond),l.Kb(1),l.kc("ngIf",n.validateForm()||n.waitingForResponse)}}function I(n,s){1&n&&(l.Xb(0,"ion-label"),l.wc(1,"On"),l.Wb())}function C(n,s){1&n&&(l.Xb(0,"ion-label"),l.wc(1,"Off"),l.Wb())}const E=[{path:"",component:(()=>{class n{constructor(n,s,i,t){this.toastController=n,this.localNotifications=s,this.openNativeSettings=i,this.http=t,this.placeholderPassword="12345678",this.oldPassword="",this.newPasswordFirst="",this.newPasswordSecond="",this.emailPattern=/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/,this.editingPassword=!1,this.waitingForResponse=!1}ngOnInit(){this.userEmail=localStorage.getItem("username"),this.boundEmail=this.userEmail}ionViewWillEnter(){this.updateNotification=Object(w.a)(2e3).subscribe(()=>Object(r.b)(this,void 0,void 0,(function*(){this.notifications=yield this.localNotifications.hasPermission()})))}ionViewWillLeave(){return Object(r.b)(this,void 0,void 0,(function*(){this.updateNotification.unsubscribe()}))}validateEmail(){return this.boundEmail!=this.userEmail?this.emailPattern.test(this.boundEmail):null}validatePasswords(){if(this.editingPassword){let n=!0;return n=n&&this.validatePassword(this.newPasswordFirst),n=n&&this.validatePassword(this.newPasswordSecond),n=n&&this.validatePassword(this.oldPassword),n&&this.newPasswordFirst==this.newPasswordSecond&&""!=this.oldPassword&&""!=this.newPasswordFirst&&this.oldPassword!=this.newPasswordFirst}return null}validatePassword(n){return/[a-z]/.test(n)&&/[A-Z]/.test(n)&&/[0-9]/.test(n)&&n.length>=7&&n.length<=16&&n.indexOf(" ")<0}formTouched(){return this.boundEmail!=this.userEmail||this.editingPassword}validateForm(){return(this.validateEmail()||null==this.validateEmail())&&(this.validatePasswords()||null==this.validatePasswords())&&this.formTouched()}saveForm(){if(this.validateForm()){let n={email:localStorage.getItem("username"),oldpassword:this.oldPassword,newpassword:this.newPasswordFirst};const s={headers:new u.c({"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer "+localStorage.getItem("token")})};this.waitingForResponse=!0,this.http.put("https://crossfacerecognition.herokuapp.com/changepassword/",n,s).subscribe(()=>{this.waitingForResponse=!1,this.resetPasswordForm(),this.successToast("Your settings have been saved")},n=>{this.waitingForResponse=!1,this.dangerToast("Password does not match"==n.error?"Old password incorrect":"Something went wrong. Please try again later")})}else this.dangerToast("Invalid fields")}resetPasswordForm(){this.editingPassword=!1,this.oldPassword="",this.newPasswordFirst="",this.newPasswordSecond=""}dangerToast(n){return Object(r.b)(this,void 0,void 0,(function*(){(yield this.toastController.create({message:n,color:"danger",duration:2e3})).present()}))}successToast(n){return Object(r.b)(this,void 0,void 0,(function*(){(yield this.toastController.create({message:n,color:"success",duration:2e3})).present()}))}openSettings(){this.openNativeSettings.open("application_details")}}return n.\u0275fac=function(s){return new(s||n)(l.Ub(o.P),l.Ub(d.a),l.Ub(b),l.Ub(u.a))},n.\u0275cmp=l.Ob({type:n,selectors:[["app-user-settings"]],decls:26,vars:12,consts:[["slot","start"],["autoHide","false"],[2,"--background","gray"],[2,"margin-top","5%","margin-left","5%","display","flex","align-items","center","justify-content","space-between"],[2,"color","white"],["style","align-self: flex-end; margin-right: 5%; font-size: 120%","name","close-circle-outline",3,"click",4,"ngIf"],["lines","none","disabled","",3,"ngClass"],["type","email","clearInput","",3,"ngModel","ngModelChange"],["style","color: white; margin-top: 2%; margin-left: 7%; font-size: 4vw",4,"ngIf"],["lines","none",3,"disabled",4,"ngIf"],[4,"ngIf"],[2,"margin-top","5%","margin-left","5%"],["button","","lines","none",3,"click"],["name","close-circle-outline",2,"align-self","flex-end","margin-right","5%","font-size","120%",3,"click"],[2,"color","white","margin-top","2%","margin-left","7%","font-size","4vw"],["lines","none",3,"disabled"],["type","password","button","",3,"value","click"],["lines","none",3,"ngClass","disabled"],["placeholder","Old Password","type","password","clearInput","",3,"ngModel","ngModelChange"],["placeholder","New Password","type","password","clearInput","",3,"ngModel","ngModelChange"],["placeholder","Confirm Password","type","password","clearInput","",3,"ngModel","ngModelChange"],["lines","none","style","--background: grey; border-radius: 0px; margin-left: 0px; margin-right: 0px",4,"ngIf"],["lines","none",2,"--background","grey","border-radius","0px","margin-left","0px","margin-right","0px"],[2,"height","90%","width","45%","margin-left","50%",3,"disabled","click"],["name","dots",4,"ngIf"],["name","dots"]],template:function(n,s){1&n&&(l.Xb(0,"ion-header"),l.Xb(1,"ion-toolbar"),l.Xb(2,"ion-title"),l.wc(3,"Settings"),l.Wb(),l.Xb(4,"ion-buttons",0),l.Vb(5,"ion-menu-button",1),l.Wb(),l.Wb(),l.Wb(),l.Xb(6,"ion-content",2),l.Xb(7,"div",3),l.Xb(8,"div",4),l.wc(9,"Email Address:"),l.Wb(),l.vc(10,g,1,0,"ion-icon",5),l.Wb(),l.Xb(11,"ion-item",6),l.Xb(12,"ion-input",7),l.fc("ngModelChange",(function(n){return s.boundEmail=n})),l.Wb(),l.Wb(),l.vc(13,f,2,0,"div",8),l.Xb(14,"div",3),l.Xb(15,"div",4),l.wc(16,"Password:"),l.Wb(),l.vc(17,h,1,0,"ion-icon",5),l.Wb(),l.vc(18,p,2,2,"ion-item",9),l.vc(19,y,11,22,"div",10),l.Xb(20,"div",11),l.Xb(21,"div",4),l.wc(22,"Notifications:"),l.Wb(),l.Wb(),l.Xb(23,"ion-item",12),l.fc("click",(function(){return s.openSettings()})),l.vc(24,I,2,0,"ion-label",10),l.vc(25,C,2,0,"ion-label",10),l.Wb(),l.Wb()),2&n&&(l.Kb(10),l.kc("ngIf",s.boundEmail!=s.userEmail&&!s.waitingForResponse),l.Kb(1),l.kc("ngClass",l.oc(9,X,s.validateEmail(),s.boundEmail!=s.userEmail&&!s.validateEmail())),l.Kb(1),l.kc("ngModel",s.boundEmail),l.Kb(1),l.kc("ngIf",s.boundEmail!=s.userEmail&&!s.validateEmail()),l.Kb(4),l.kc("ngIf",s.editingPassword&&!s.waitingForResponse),l.Kb(1),l.kc("ngIf",!s.editingPassword),l.Kb(1),l.kc("ngIf",s.editingPassword),l.Kb(5),l.kc("ngIf",s.notifications),l.Kb(1),l.kc("ngIf",!s.notifications))},directives:[o.l,o.F,o.D,o.f,o.s,o.j,t.j,o.o,t.h,o.n,o.O,e.f,e.h,o.m,o.e,o.C,o.p],styles:["ion-item[_ngcontent-%COMP%]{margin-left:5%;margin-right:5%;margin-top:5%;border-radius:10px;background-color:#fff}.invalid[_ngcontent-%COMP%]{--background:#ffd1d1}.valid[_ngcontent-%COMP%]{--background:#cffdd9}"]}),n})()}];let K=(()=>{class n{}return n.\u0275mod=l.Sb({type:n}),n.\u0275inj=l.Rb({factory:function(s){return new(s||n)},imports:[[a.i.forChild(E)],a.i]}),n})(),S=(()=>{class n{}return n.\u0275mod=l.Sb({type:n}),n.\u0275inj=l.Rb({factory:function(s){return new(s||n)},providers:[d.a,b],imports:[[t.b,e.d,o.G,K]]}),n})()}}]);